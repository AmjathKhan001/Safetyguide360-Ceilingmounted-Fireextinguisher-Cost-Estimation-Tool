<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ceiling Mounted Fire Extinguisher Cost Estimation Tool | SafetyGuide360</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Free professional tool to calculate ceiling mounted modular fire extinguisher requirements. Generate PDF/Excel quotes instantly. Perfect for safety consultants, contractors, and facility managers.">
    <meta name="keywords" content="fire extinguisher calculator, modular fire system, safety equipment cost, fire protection quote, HSE tools, fire safety assessment">
    <meta name="author" content="SafetyGuide360">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Modular Fire Extinguisher Calculator | SafetyGuide360">
    <meta property="og:description" content="Free professional tool for fire safety calculations and commercial quotes">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://safetyguide360.com">
    <meta property="og:image" content="https://img.icons8.com/color/480/000000/fire-extinguisher.png">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Modular Fire Extinguisher Calculator | SafetyGuide360">
    <meta name="twitter:description" content="Free professional tool for fire safety calculations and commercial quotes">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://safetyguide360.com">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://img.icons8.com/color/96/000000/fire-extinguisher.png">
    <link rel="apple-touch-icon" href="https://img.icons8.com/color/180/000000/fire-extinguisher.png">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google AdSense Auto Ads -->
    <script async src="https://pagead2.googletagmanager.com/pagead/js/adsbygoogle.js?client=ca-pub-6687860250561653"
     crossorigin="anonymous"></script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VB6549D0LW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-VB6549D0LW');
    </script>

    <!-- Alibaba Verification -->
    <meta name="microtip-cn-site-verification" content="fp8yUzPYNNQfwruXQGPkzlwyXLGsI5acRmlc4wiRG1d4U+K8oisRkw==">

    <style>
        /* Print styling */
        @media print {
            body * { visibility: hidden; }
            #resultsSection, #resultsSection * { visibility: visible; }
            #resultsSection { position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 0; }
            .no-print { display: none !important; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
        
        /* Custom Color Variables */
        :root {
            --primary-red: #ff4c4c;
            --primary-blue: #0099e5;
            --primary-green: #34bf49;
            --primary-black: #000000;
        }
        
        /* Custom Button Gradients */
        .btn-amazon {
            background: linear-gradient(to bottom, #f0c14b, #f7dfa5);
            border-color: #a88734 #9c7e31 #846a29;
            color: #111;
        }
        .btn-amazon:hover {
            background: linear-gradient(to bottom, #f7dfa5, #f0c14b);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(240, 193, 75, 0.3);
        }
        
        .btn-coffee {
            background: linear-gradient(135deg, #ff4c4c 0%, #ff7b7b 100%);
            color: white;
            font-family: 'Comic Sans MS', cursive, sans-serif;
        }
        .btn-coffee:hover {
            background: linear-gradient(135deg, #ff3333 0%, #ff6b6b 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 76, 76, 0.4);
        }
        
        .btn-clearance {
            background: linear-gradient(135deg, #34bf49 0%, #5cdb6b 100%);
            color: white;
            font-weight: bold;
            border: none;
        }
        .btn-clearance:hover {
            background: linear-gradient(135deg, #2da83e 0%, #4bc75a 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 191, 73, 0.4);
        }

        /* Modal Styles */
        .modal {
            transition: opacity 0.25s ease;
        }
        body.modal-active {
            overflow-x: hidden;
            overflow-y: hidden !important;
        }
        
        /* Custom Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.5s ease-out;
        }
        
        /* Tool Card Hover Effects */
        .tool-card {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #0099e5;
        }
        
        /* Progress Bar */
        .progress-bar {
            height: 4px;
            background: linear-gradient(90deg, #ff4c4c 0%, #0099e5 50%, #34bf49 100%);
            transition: width 0.3s ease;
        }
        
        /* Calculate button */
        #calculateBtn {
            background: linear-gradient(135deg, #0099e5 0%, #34bf49 100%);
        }
        #calculateBtn:hover {
            background: linear-gradient(135deg, #0088cc 0%, #2da83e 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 153, 229, 0.3);
        }
        
        /* Social sharing buttons */
        .social-btn {
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .social-btn:hover {
            transform: translateY(-3px);
        }
        
        /* Mobile optimization */
        @media (max-width: 768px) {
            .mobile-stack {
                flex-direction: column !important;
            }
            .mobile-full {
                width: 100% !important;
            }
            .mobile-text-center {
                text-align: center !important;
            }
            .mobile-p-3 {
                padding: 0.75rem !important;
            }
        }
        
        /* SEO Optimized Typography */
        h1, h2, h3, h4 {
            font-weight: 700;
            line-height: 1.2;
        }
        
        /* Schema.org structured data highlight */
        .structured-data {
            display: none;
        }
        
        /* Breadcrumb styling */
        .breadcrumb {
            font-size: 0.875rem;
            color: #666;
        }
        
        /* Accessibility improvements */
        :focus {
            outline: 2px solid #0099e5;
            outline-offset: 2px;
        }
        
        /* Loading skeleton */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Visitor Counter Styles */
        #visitorCounter {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            background: linear-gradient(90deg, #ff4c4c, #0099e5, #34bf49);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .visitor-counter-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(102, 126, 234, 0); }
            100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
        }
        
        /* Contact Info Icons */
        .contact-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        /* Social media hover effects */
        .fa-twitter:hover { color: #1DA1F2 !important; }
        .fa-facebook-f:hover { color: #1877F2 !important; }
        .fa-instagram:hover { color: #E4405F !important; }
        .fa-whatsapp:hover { color: #25D366 !important; }
        .fa-linkedin-in:hover { color: #0A66C2 !important; }
    </style>
</head>
<body class="bg-slate-50 text-gray-800 font-sans flex flex-col min-h-screen">

    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Ceiling Mounted Fire Extinguisher Calculator",
        "url": "https://safetyguide360.com",
        "description": "Professional tool for calculating ceiling mounted modular fire extinguisher requirements and generating commercial quotes",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "SafetyGuide360"
        }
    }
    </script>

    <!-- Progress Bar -->
    <div class="fixed top-0 left-0 right-0 z-50">
        <div id="progressBar" class="progress-bar" style="width: 0%"></div>
    </div>

    <header class="bg-white shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-4 py-3 flex flex-col md:flex-row justify-between items-center gap-4">
            <a href="index.html" class="flex items-center space-x-3 group">
                <div class="bg-gradient-to-r from-blue-500 to-green-500 text-white p-2 rounded-lg group-hover:opacity-90 transition duration-300">
                    <i class="fas fa-shield-alt text-xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-gray-800 tracking-tight">SafetyGuide360</h1>
                    <p class="text-xs text-gray-500 uppercase tracking-wider">Professional Fire Safety Tools</p>
                </div>
            </a>
            
            <div class="flex flex-col md:flex-row items-center space-y-2 md:space-y-0 md:space-x-4">
                <!-- Social Sharing Buttons -->
                <div class="flex space-x-2">
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://safetyguide360.com" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       class="social-btn bg-blue-600 hover:bg-blue-700 text-white"
                       aria-label="Share on Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://twitter.com/intent/tweet?url=https://safetyguide360.com&text=Check%20out%20this%20awesome%20Fire%20Safety%20Calculator%20Tool%20by%20SafetyGuide360" 
                       target="_blank"
                       rel="noopener noreferrer"
                       class="social-btn bg-black hover:bg-gray-800 text-white"
                       aria-label="Share on Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://safetyguide360.com&title=Fire%20Safety%20Calculator%20Tool&summary=Professional%20tool%20for%20fire%20safety%20calculations" 
                       target="_blank"
                       rel="noopener noreferrer"
                       class="social-btn bg-blue-700 hover:bg-blue-800 text-white"
                       aria-label="Share on LinkedIn">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://wa.me/?text=Check%20out%20this%20Fire%20Safety%20Calculator%20Tool%3A%20https%3A%2F%2Fsafetyguide360.com" 
                       target="_blank"
                       rel="noopener noreferrer"
                       class="social-btn bg-green-500 hover:bg-green-600 text-white"
                       aria-label="Share on WhatsApp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                </div>
                
                <!-- Buy Me a Coffee Button -->
                <a href="https://buymeacoffee.com/s.amjathkhan" target="_blank" rel="noopener noreferrer" class="btn-coffee px-4 py-2 rounded-full font-bold flex items-center space-x-2 transition-all shadow-sm ml-0 md:ml-4">
                    <i class="fas fa-coffee text-lg"></i>
                    <span>Buy me a coffee</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Breadcrumb Navigation -->
    <nav class="bg-gray-100 border-b" aria-label="Breadcrumb">
        <div class="container mx-auto px-4 py-2">
            <ol class="breadcrumb flex items-center space-x-2 text-sm">
                <li><a href="index.html" class="text-blue-600 hover:underline">Home</a></li>
                <li><i class="fas fa-chevron-right text-gray-400 text-xs"></i></li>
                <li class="text-gray-600">Ceiling Mounted Fire Extinguisher Calculator</li>
            </ol>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8 max-w-5xl flex-grow">

        <!-- Amazon Associates Section -->
        <div class="mb-8 grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col md:flex-row items-center justify-between bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                <div class="flex items-center space-x-3 mb-3 md:mb-0">
                    <i class="fab fa-amazon text-3xl text-yellow-600"></i>
                    <div>
                        <h3 class="font-bold text-gray-800">Need Fire Safety Equipment?</h3>
                        <p class="text-sm text-gray-600">Browse top-rated extinguishers and safety gear on Amazon.</p>
                    </div>
                </div>
                <a href="https://amzn.to/49YYGrJ" target="_blank" rel="noopener noreferrer" class="btn-amazon px-6 py-2 rounded shadow text-sm font-bold flex items-center hover:shadow-md transition mt-2 md:mt-0">
                    Shop Now <i class="fas fa-external-link-alt ml-2 text-xs"></i>
                </a>
            </div>
            
            <div class="flex flex-col md:flex-row items-center justify-between bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-xl shadow-sm border border-green-200">
                <div class="flex items-center space-x-3 mb-3 md:mb-0">
                    <i class="fas fa-fire-extinguisher text-2xl text-green-600"></i>
                    <div>
                        <h3 class="font-bold text-gray-800">Clearance Sale Store!</h3>
                        <p class="text-sm text-gray-600">Upto 70% Off on Fire Safety Equipment</p>
                    </div>
                </div>
                <a href="https://amzn.to/4p8ceG6" target="_blank" rel="noopener noreferrer" class="btn-clearance px-6 py-2 rounded shadow text-sm font-bold flex items-center hover:shadow-md transition mt-2 md:mt-0">
                    Shop Deals <i class="fas fa-bolt ml-2 text-xs"></i>
                </a>
            </div>
        </div>

        <!-- Google AdSense Ad Unit -->
        <div class="mb-8 text-center bg-gray-100 rounded-lg overflow-hidden min-h-[90px] flex items-center justify-center border border-dashed border-gray-300">
            <span class="text-xs text-gray-400 block mb-1 w-full text-center">Advertisement</span>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-6687860250561653"
                 data-ad-slot="3608723820"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

        <!-- Main Heading with Schema -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-3">Ceiling Mounted Fire Extinguisher Calculator</h1>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">Professional tool for calculating modular fire extinguisher requirements and generating instant PDF/Excel quotes for your clients</p>
        </div>

        <!-- Information Banner -->
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-500 p-6 mb-8 rounded-r-lg shadow-sm">
            <h2 class="text-lg font-bold text-blue-900 mb-2"><i class="fas fa-info-circle mr-2"></i>How to Create a Commercial Offer</h2>
            <p class="text-blue-800 text-sm mb-2">Use this professional tool to calculate requirements for Modular Fire Extinguishers and generate detailed PDF/Excel quotes for your clients.</p>
            <ul class="list-disc list-inside text-sm text-blue-800 space-y-1 ml-2">
                <li>Input your organization details and your customer's contact information</li>
                <li>Select the extinguishing agent and cylinder size based on fire class</li>
                <li>Add room dimensions to automatically calculate required units</li>
                <li>Generate professional PDF/Excel quotes with GST calculations</li>
            </ul>
        </div>

        <!-- Organization Details -->
        <section class="bg-white rounded-xl shadow-md p-6 mb-6 border-t-4 border-gray-800">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center"><i class="fas fa-building mr-2 text-gray-500"></i> Organization Details</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-gray-700 mb-3 text-sm uppercase tracking-wide flex items-center">
                        <i class="fas fa-user-tie mr-2"></i> Vendor (Your Details)
                    </h3>
                    <div class="space-y-3">
                        <div>
                            <label for="vendorName" class="block text-xs text-gray-500 mb-1">Company Name *</label>
                            <input type="text" id="vendorName" placeholder="Enter your company name" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                        </div>
                        <div>
                            <label for="vendorContact" class="block text-xs text-gray-500 mb-1">Contact Details *</label>
                            <input type="text" id="vendorContact" placeholder="Email / Phone / Address" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-gray-700 mb-3 text-sm uppercase tracking-wide flex items-center">
                        <i class="fas fa-users mr-2"></i> Customer (Client Details)
                    </h3>
                    <div class="space-y-3">
                        <div>
                            <label for="clientName" class="block text-xs text-gray-500 mb-1">Client Name *</label>
                            <input type="text" id="clientName" placeholder="Enter client name" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                        </div>
                        <div>
                            <label for="projectRef" class="block text-xs text-gray-500 mb-1">Project Reference</label>
                            <input type="text" id="projectRef" placeholder="Site Location / RFQ No." class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Product Configuration -->
        <section class="bg-white rounded-xl shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center"><i class="fas fa-cogs mr-2 text-gray-500"></i> Product Configuration</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="agentType" class="block font-semibold mb-2 text-sm">Extinguisher Agent</label>
                    <div class="relative">
                        <select id="agentType" class="w-full p-3 border rounded bg-gray-50 appearance-none focus:ring-2 focus:ring-blue-500 outline-none transition">
                            <option value="FE36">Clean Agent FE36 (Premium) - Best for Electronics</option>
                            <option value="HFC236fa">Clean Agent HFC 236fa - Data Centers</option>
                            <option value="MAP50">Dry Powder MAP-50% (Standard) - General Use</option>
                            <option value="MAP90">Dry Powder MAP-90% (High Performance) - Industrial</option>
                        </select>
                        <i class="fas fa-chevron-down absolute right-4 top-4 text-gray-400 pointer-events-none"></i>
                    </div>
                </div>
                <div>
                    <label for="extinguisherSize" class="block font-semibold mb-2 text-sm">Cylinder Capacity</label>
                    <div class="relative">
                        <select id="extinguisherSize" class="w-full p-3 border rounded bg-gray-50 appearance-none focus:ring-2 focus:ring-blue-500 outline-none transition">
                            <option value="2">2 kg (Small Rooms - Covers 1.5 m²)</option>
                            <option value="5">5 kg (Medium Rooms - Covers 2.5 m²)</option>
                            <option value="10">10 kg (Large Rooms - Covers 5.0 m²)</option>
                            <option value="15">15 kg (Industrial - Covers 6.0 m²)</option>
                        </select>
                        <i class="fas fa-chevron-down absolute right-4 top-4 text-gray-400 pointer-events-none"></i>
                    </div>
                </div>
            </div>
        </section>

        <!-- Room Dimensions -->
        <section class="bg-white rounded-xl shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center"><i class="fas fa-ruler-combined mr-2 text-gray-500"></i> Room Dimensions</h2>
            
            <!-- Add Room Form -->
            <div class="bg-gradient-to-r from-gray-50 to-white p-4 rounded-lg border border-gray-200 mb-4 shadow-sm">
                <div class="grid grid-cols-1 md:grid-cols-7 gap-3 items-end">
                    <div class="md:col-span-3">
                        <label for="customRoomName" class="block text-xs font-bold text-gray-500 mb-1">Room Description *</label>
                        <input type="text" id="customRoomName" placeholder="e.g. Server Room, Office Hall, Warehouse" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                    </div>
                    <div class="md:col-span-2">
                        <label for="customRoomLength" class="block text-xs font-bold text-gray-500 mb-1">Length (meters) *</label>
                        <input type="number" id="customRoomLength" placeholder="0.0" step="0.1" min="0.1" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                    </div>
                    <div class="md:col-span-2">
                        <label for="customRoomWidth" class="block text-xs font-bold text-gray-500 mb-1">Width (meters) *</label>
                        <div class="flex space-x-2">
                            <input type="number" id="customRoomWidth" placeholder="0.0" step="0.1" min="0.1" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                            <button id="addCustomRoom" class="bg-gradient-to-r from-green-600 to-green-500 text-white px-4 py-2 rounded hover:from-green-700 hover:to-green-600 transition shadow-sm flex items-center">
                                <i class="fas fa-plus mr-2"></i> Add
                            </button>
                        </div>
                    </div>
                </div>
                <p class="text-xs text-gray-500 mt-2">* Press Enter in Width field to quickly add room</p>
            </div>
            
            <!-- Rooms Table -->
            <div class="overflow-hidden rounded-lg border border-gray-200 shadow-sm">
                <table class="w-full text-left text-sm">
                    <thead class="bg-gradient-to-r from-gray-100 to-gray-50 text-gray-600 font-semibold uppercase tracking-wider">
                        <tr>
                            <th class="p-3">Room Name</th>
                            <th class="p-3 text-center">Dimensions (m)</th>
                            <th class="p-3 text-center">Area (m²)</th>
                            <th class="p-3 text-right">Action</th>
                        </tr>
                    </thead>
                    <tbody id="customRoomsList" class="divide-y divide-gray-200 bg-white">
                        <!-- Rooms will be added here dynamically -->
                    </tbody>
                </table>
                <div id="emptyState" class="p-8 text-center text-gray-400 bg-white">
                    <i class="fas fa-door-closed text-4xl mb-3 opacity-30"></i>
                    <p class="text-gray-500 font-medium mb-1">No rooms added yet</p>
                    <p class="text-sm text-gray-400">Add your first room using the form above</p>
                </div>
            </div>
            
            <div class="flex justify-between items-center mt-4">
                <span id="totalRooms" class="text-sm text-gray-500">Total Rooms: 0</span>
                <span id="totalArea" class="text-sm font-medium text-gray-700">Total Area: 0 m²</span>
            </div>
        </section>

        <!-- Calculate Button -->
        <button id="calculateBtn" class="w-full bg-gradient-to-r from-blue-600 to-green-500 hover:from-blue-700 hover:to-green-600 text-white text-xl font-bold py-4 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition duration-300 mb-8 flex items-center justify-center gap-3 group">
            <i class="fas fa-calculator group-hover:scale-110 transition-transform"></i> 
            <span>Calculate Requirements & Generate Quote</span>
        </button>

        <!-- Results Section -->
        <section id="resultsSection" class="hidden animate-fade-in-up">
            <div class="bg-white rounded-xl shadow-xl overflow-hidden border border-gray-200">
                <!-- Results Header -->
                <div class="p-6 bg-gradient-to-r from-gray-900 to-gray-800 text-white flex flex-col md:flex-row justify-between items-start md:items-center">
                    <div>
                        <h2 class="text-2xl font-bold text-white">Commercial Offer</h2>
                        <p class="text-gray-300 text-sm">SafetyGuide360 Calculation Engine</p>
                    </div>
                    <div class="no-print mt-4 md:mt-0 flex flex-wrap gap-2">
                        <button id="exportPDF" class="bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-4 py-2 rounded shadow hover:shadow-lg transition flex items-center text-sm font-bold">
                            <i class="fas fa-file-pdf mr-2"></i> Download PDF
                        </button>
                        <button id="exportExcel" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-4 py-2 rounded shadow hover:shadow-lg transition flex items-center text-sm font-bold">
                            <i class="fas fa-file-excel mr-2"></i> Download Excel
                        </button>
                        <button onclick="window.print()" class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-4 py-2 rounded shadow hover:shadow-lg transition flex items-center text-sm font-bold">
                            <i class="fas fa-print mr-2"></i> Print
                        </button>
                    </div>
                </div>

                <!-- Results Content -->
                <div class="p-8">
                    <!-- Vendor & Client Info -->
                    <div class="flex flex-col md:flex-row justify-between mb-8 pb-6 border-b border-gray-200 gap-6">
                        <div class="w-full md:w-1/2">
                            <span class="text-xs uppercase font-bold text-gray-400 tracking-wider">From (Vendor)</span>
                            <div class="mt-1">
                                <p class="text-lg font-bold text-gray-800" id="displayVendorName">--</p>
                                <p class="text-gray-600" id="displayVendorContact">--</p>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 md:text-right">
                            <span class="text-xs uppercase font-bold text-gray-400 tracking-wider">To (Client)</span>
                            <div class="mt-1">
                                <p class="text-lg font-bold text-gray-800" id="displayClientName">--</p>
                                <p class="text-gray-600" id="displayProjectRef">--</p>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Card -->
                    <div id="summaryContent" class="bg-gradient-to-r from-green-50 to-emerald-50 text-green-900 p-4 rounded-lg mb-6 border border-green-100 flex items-start shadow-sm">
                        <i class="fas fa-check-circle mt-1 mr-3 text-green-500 text-xl"></i>
                        <div>
                            <p class="font-bold text-lg">Requirement Calculated Successfully!</p>
                            <p class="text-sm opacity-90">Based on your room configurations, here's what you need:</p>
                        </div>
                    </div>

                    <!-- Quote Table -->
                    <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm mb-6">
                        <table class="w-full">
                            <thead>
                                <tr class="bg-gradient-to-r from-gray-50 to-gray-100 text-gray-600 uppercase text-xs leading-normal">
                                    <th class="py-3 px-4 text-left">Description</th>
                                    <th class="py-3 px-4 text-center">Qty</th>
                                    <th class="py-3 px-4 text-right">Unit Rate (₹)</th>
                                    <th class="py-3 px-4 text-right">Net Amount (₹)</th>
                                    <th class="py-3 px-4 text-right">GST 18% (₹)</th>
                                    <th class="py-3 px-4 text-right">Total (₹)</th>
                                </tr>
                            </thead>
                            <tbody id="quoteContent" class="text-gray-700 text-sm">
                                <!-- Quote content will be added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Room Breakdown (Accordion) -->
                    <details class="group border border-gray-200 rounded-lg overflow-hidden no-print shadow-sm">
                        <summary class="flex justify-between items-center p-4 bg-gray-50 cursor-pointer font-semibold text-gray-700 hover:bg-gray-100 transition">
                            <span class="flex items-center">
                                <i class="fas fa-table mr-2"></i>
                                View Room-wise Breakdown
                            </span>
                            <span class="transition-transform group-open:rotate-180">
                                <i class="fas fa-chevron-down"></i>
                            </span>
                        </summary>
                        <div class="p-4 bg-white">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b text-gray-500">
                                        <th class="text-left p-2">Room</th>
                                        <th class="text-center p-2">Area (m²)</th>
                                        <th class="text-center p-2">Coverage per Unit</th>
                                        <th class="text-center p-2">Units Required</th>
                                    </tr>
                                </thead>
                                <tbody id="breakdownContent">
                                    <!-- Breakdown content will be added here -->
                                </tbody>
                            </table>
                        </div>
                    </details>
                </div>
                
                <!-- Footer Note -->
                <div class="bg-gradient-to-r from-gray-50 to-gray-100 p-4 text-center text-xs text-gray-500 border-t">
                    <i class="fas fa-exclamation-circle mr-1"></i>
                    Note: This is a system-generated estimate. Verify actual site conditions and consult with certified fire safety professionals before installation.
                </div>
            </div>
        </section>

        <!-- Explore More Tools Section -->
        <section class="mt-12 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center flex items-center justify-center">
                <i class="fas fa-tools mr-3 text-blue-500"></i>
                Explore More Calculators & Tools
            </h2>
            <p class="text-gray-600 text-center mb-8 max-w-2xl mx-auto">
                We highly recommend these expert resources for specialized safety, HSE, and utility calculations. 
                Each tool is designed to save you time and ensure compliance with industry standards.
            </p>
            
            <!-- HSE Tools Category -->
            <div class="mb-10">
                <div class="flex items-center mb-6">
                    <div class="bg-green-100 p-3 rounded-lg mr-3">
                        <i class="fas fa-heartbeat text-green-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800"> HSE Tools</h3>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- HSE Calculators -->
                    <a href="https://www.hsecalculator.com" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-green-300 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-green-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-calculator text-green-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">HSE Calculators</h3>
                                <p class="text-sm text-gray-500">Complete HSE Calculation Suite</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Comprehensive collection of health, safety, and environment calculators for risk assessment, compliance, and safety management.
                        </p>
                        <div class="flex items-center text-green-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- HSE Toolkit -->
                    <a href="https://hse-toolkit.vercel.app" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-green-400 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-green-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-toolbox text-green-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">HSE Toolkit</h3>
                                <p class="text-sm text-gray-500">Complete Safety Management</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Comprehensive Health, Safety and Environment toolkit for risk management, audits, compliance checks and safety documentation.
                        </p>
                        <div class="flex items-center text-green-600 text-sm font-medium">
                            <span>Explore Toolkit</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>
                </div>
            </div>
            
            <!-- Fire Safety Tools Category -->
            <div class="mb-10">
                <div class="flex items-center mb-6">
                    <div class="bg-red-100 p-3 rounded-lg mr-3">
                        <i class="fas fa-fire-extinguisher text-red-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800"> Fire Safety Tools</h3>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Ceiling Mounted Fire Extinguisher Estimation Tool -->
                    <a href="https://ceiling-fire-extinguisher-cost-esti.vercel.app" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-red-300 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-red-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-fire text-red-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Ceiling Mounted Fire Extinguisher</h3>
                                <p class="text-sm text-gray-500">Modular System Estimation</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Professional tool for calculating ceiling mounted modular fire extinguisher requirements and generating commercial quotes.
                        </p>
                        <div class="flex items-center text-red-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Fire Safety Calculators -->
                    <a href="https://www.firesafetytool.com" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-red-400 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-red-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-fire-extinguisher text-red-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Fire Safety Calculators</h3>
                                <p class="text-sm text-gray-500">Complete Fire Safety Solutions</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Comprehensive fire safety assessment, risk analysis, and compliance checking tools for commercial and residential buildings.
                        </p>
                        <div class="flex items-center text-red-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Fire Extinguisher Health Checkup Audit Tool -->
                    <a href="https://fire-extinguisher-audit-tool.vercel.app" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-red-500 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-red-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-clipboard-check text-red-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Fire Extinguisher Audit Tool</h3>
                                <p class="text-sm text-gray-500">Health Checkup & Inspection</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Specialized tool for conducting thorough fire extinguisher audits, maintenance tracking, and compliance reporting.
                        </p>
                        <div class="flex items-center text-red-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Fire Safety Assessment Tool -->
                    <a href="https://firesafetyassessmenttool.vercel.app" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-orange-300 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-orange-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-shield-alt text-orange-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Fire Safety Assessment Tool</h3>
                                <p class="text-sm text-gray-500">Risk Assessment & Compliance</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Complete fire safety assessment and risk evaluation tool for buildings, facilities, and industrial establishments.
                        </p>
                        <div class="flex items-center text-orange-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Fire Extinguisher Estimation Tool -->
                    <a href="https://fire-extinguisher-calculator.vercel.app" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-orange-400 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-orange-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-calculator text-orange-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Fire Extinguisher Estimation Tool</h3>
                                <p class="text-sm text-gray-500">Portable Extinguisher Planning</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Specialized tool for calculating requirements and costs for portable fire extinguishers in various building types.
                        </p>
                        <div class="flex items-center text-orange-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Kitchen Suppression System Estimation Tool -->
                    <a href="https://kitchen-fire-suppression-calculator.vercel.app" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-yellow-300 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-yellow-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-utensils text-yellow-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Kitchen Suppression System</h3>
                                <p class="text-sm text-gray-500">Commercial Kitchen Safety</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Calculator for commercial kitchen fire suppression systems, hood protection, and wet chemical extinguishing requirements.
                        </p>
                        <div class="flex items-center text-yellow-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Room Flooding System Estimation Tool -->
                    <a href="https://fm-200-room-flooding-system-calcula.vercel.app" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-indigo-300 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-indigo-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-flood text-indigo-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Room Flooding System</h3>
                                <p class="text-sm text-gray-500">FM-200 Clean Agent Systems</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Calculator for FM-200 and other clean agent room flooding systems for data centers, server rooms, and sensitive equipment.
                        </p>
                        <div class="flex items-center text-indigo-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Panel Fire Suppression Calculator -->
                    <a href="https://panel-fire-suppression-calculator.vercel.app/index.html" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-purple-300 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-purple-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-th-large text-purple-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Panel Fire Suppression Calculator</h3>
                                <p class="text-sm text-gray-500">Electrical Panel Protection</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Specialized calculator for electrical panel and control panel fire suppression systems using clean agents.
                        </p>
                        <div class="flex items-center text-purple-600 text-sm font-medium">
                            <span>Explore Tool</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>
                </div>
            </div>
            
            <!-- Utility Tools Category -->
            <div>
                <div class="flex items-center mb-6">
                    <div class="bg-blue-100 p-3 rounded-lg mr-3">
                        <i class="fas fa-globe text-blue-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800"> Utility Tools</h3>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Daily Smart Tool -->
                    <a href="https://www.dailysmarttool.com" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-blue-300 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-blue-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-wrench text-blue-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Daily Smart Tool</h3>
                                <p class="text-sm text-gray-500">Utility & Productivity Tools</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Collection of daily useful tools for calculations, conversions, text processing, and productivity enhancement.
                        </p>
                        <div class="flex items-center text-blue-600 text-sm font-medium">
                            <span>Explore Tools</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>

                    <!-- Web Tools Daily -->
                    <a href="https://www.webtoolsdaily.com" target="_blank" rel="noopener noreferrer" class="tool-card bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:border-blue-400 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="bg-blue-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-tools text-blue-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Web Tools Daily</h3>
                                <p class="text-sm text-gray-500">Developer & Productivity Tools</p>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">
                            Daily updated collection of web development tools, productivity enhancers, code generators, and online utilities for professionals.
                        </p>
                        <div class="flex items-center text-blue-600 text-sm font-medium">
                            <span>Explore Tools</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </div>
                    </a>
                </div>
            </div>
        </section>

        <!-- Google AdSense Ad Unit -->
        <div class="my-8 text-center bg-white p-4 rounded shadow-sm border border-dashed border-gray-300">
             <span class="text-xs text-gray-400 block mb-2">Advertisement</span>
             <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-format="fluid"
                 data-ad-layout-key="-gw-3+1f-3d+2z"
                 data-ad-client="ca-pub-6687860250561653"
                 data-ad-slot="3608723820"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-b from-gray-900 to-black text-white py-12 mt-auto border-t-4 border-red-600">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                <!-- Brand Section -->
                <div class="text-center md:text-left">
                    <div class="flex items-center justify-center md:justify-start space-x-2 mb-3">
                        <i class="fas fa-shield-alt text-red-500 text-3xl"></i>
                        <span class="text-3xl font-bold tracking-wide">SafetyGuide360</span>
                    </div>
                    <p class="text-gray-400 text-sm mt-3 max-w-xs">
                        Your trusted partner for professional fire safety calculations, compliance tools, and safety engineering solutions.
                    </p>
                    
                    <!-- Visitor Counter -->
                    <div class="mt-4 bg-gradient-to-r from-blue-900/50 to-green-900/50 p-3 rounded-lg inline-block">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-chart-line text-green-400"></i>
                            <div>
                                <div class="text-xs text-gray-300">Total Visitors</div>
                                <div class="text-xl font-bold" id="visitorCounter">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Contact Information -->
                <div class="text-center md:text-left">
                    <h4 class="text-lg font-bold mb-4 flex items-center justify-center md:justify-start">
                        <i class="fas fa-headset mr-2"></i> Contact & Support
                    </h4>
                    <div class="space-y-2">
                        <p class="flex items-center justify-center md:justify-start">
                            <i class="fas fa-envelope mr-2 text-red-400"></i>
                            <a href="mailto:contact@amjathkhan.com" class="text-gray-300 hover:text-white transition">
                                contact@amjathkhan.com
                            </a>
                        </p>
                        <p class="flex items-center justify-center md:justify-start">
                            <i class="fas fa-phone mr-2 text-green-400"></i>
                            <a href="tel:+919750816163" class="text-gray-300 hover:text-white transition">
                                +91 97508 16163
                            </a>
                        </p>
                        <p class="text-sm text-gray-400 mt-3">
                            For queries, feedback, or business inquiries
                        </p>
                    </div>
                    
                    <!-- Social Links -->
                    <div class="mt-4">
                        <h5 class="text-sm font-semibold mb-2 text-gray-300">Connect with me:</h5>
                        <div class="flex space-x-3 justify-center md:justify-start">
                            <a href="https://bsky.app/profile/amjathkhan.bsky.social" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition" title="Bluesky">
                                <i class="fab fa-twitter text-lg"></i>
                            </a>
                            <a href="https://www.facebook.com/Amjathkhan.s" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition" title="Facebook">
                                <i class="fab fa-facebook-f text-lg"></i>
                            </a>
                            <a href="https://www.instagram.com/amjathkhan_official/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition" title="Instagram">
                                <i class="fab fa-instagram text-lg"></i>
                            </a>
                            <a href="https://x.com/amjikhan" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition" title="Twitter/X">
                                <i class="fab fa-twitter text-lg"></i>
                            </a>
                            <a href="https://www.amjathkhan.com" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition" title="Twitter/X">
                                <i class="fab fa-twitter text-lg"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Links -->
                <div class="text-center md:text-left">
                    <h4 class="text-lg font-bold mb-4">Quick Links</h4>
                    <div class="flex flex-wrap justify-center md:justify-start space-x-6 text-sm font-medium">
                        <button onclick="toggleModal('privacyModal')" class="text-gray-400 hover:text-white transition-colors hover:underline mb-2">Privacy Policy</button>
                        <button onclick="toggleModal('termsModal')" class="text-gray-400 hover:text-white transition-colors hover:underline mb-2">Terms of Service</button>
                        <button onclick="toggleModal('affiliateModal')" class="text-gray-400 hover:text-white transition-colors hover:underline mb-2">Affiliate Disclosure</button>
                    </div>
                    
                    <!-- Support Options -->
                    <div class="mt-6">
                        <h5 class="text-sm font-semibold mb-2 text-gray-300">Support Our Work:</h5>
                        <div class="flex flex-col space-y-2">
                            <a href="https://amzn.to/49YYGrJ" target="_blank" rel="noopener noreferrer" class="text-yellow-500 hover:text-yellow-400 text-sm flex items-center justify-center md:justify-start">
                                <i class="fab fa-amazon mr-2"></i> Amazon Associates Store
                            </a>
                            <a href="https://amzn.to/4p8ceG6" target="_blank" rel="noopener noreferrer" class="text-green-400 hover:text-green-300 text-sm flex items-center justify-center md:justify-start">
                                <i class="fas fa-fire mr-2"></i> Clearance Sale (Up to 70% Off)
                            </a>
                            <a href="https://buymeacoffee.com/s.amjathkhan" target="_blank" rel="noopener noreferrer" class="text-red-400 hover:text-red-300 text-sm flex items-center justify-center md:justify-start">
                                <i class="fas fa-coffee mr-2"></i> Buy Me a Coffee
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm">
                <p>&copy; 2025 SafetyGuide360. All rights reserved. | Professional Fire Safety Tools</p>
                <p class="mt-2 text-xs">This tool is for estimation purposes only. Always consult with certified fire safety professionals.</p>
                <p class="mt-1 text-xs">Google AdSense Publisher ID: pub-6687860250561653</p>
                <p class="mt-1 text-xs">Website Visitor Count: Fully Functional</p>
            </div>
        </div>
    </footer>

    <!-- Modals (Privacy, Terms, Affiliate) -->
    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="modal fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity" aria-hidden="true" onclick="toggleModal('privacyModal')"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="flex justify-between items-center border-b pb-3 mb-4">
                        <h3 class="text-2xl font-bold text-gray-900">Privacy Policy</h3>
                        <button onclick="toggleModal('privacyModal')" class="text-gray-400 hover:text-gray-600 transition"><i class="fas fa-times text-xl"></i></button>
                    </div>
                    <div class="prose max-w-none text-sm text-gray-700 space-y-4">
                        <p><strong>1. Commitment to Privacy:</strong> At SafetyGuide360, we believe that utility tools should be fast, effective, and prioritize user privacy. This policy explains what information we collect and how we use it.</p>
                        <p><strong>2. Information We DO NOT Collect:</strong> 
                            <ul class="list-disc pl-5">
                                <li><strong>User Files and Input:</strong> The core functionality of our tools is processed entirely on your device. We never upload, save, or transmit your files or data to our servers.</li>
                                <li><strong>PII:</strong> We do not require registration or collect personal identifiable information like names or emails unless you voluntarily engage with our support links.</li>
                            </ul>
                        </p>
                        <p><strong>3. Log Data and Analytics:</strong> We collect anonymous, non-personally identifiable information (Log Data) such as IP address (anonymized), browser type, and pages visited via <strong>Google Analytics</strong> to improve user experience.</p>
                        <p><strong>4. Third-Party Services:</strong> We use Google Analytics, Google AdSense, Amazon Associates, and Buy Me a Coffee. These services have their own privacy policies.</p>
                        <p><strong>5. Cookies:</strong> We use cookies for functionality and analytics. You can refuse cookies, but some portions of the service may not function properly.</p>
                        <p><strong>6. Contact:</strong> If you have questions about this policy, please contact us.</p>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm transition" onclick="toggleModal('privacyModal')">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Terms of Service Modal -->
    <div id="termsModal" class="modal fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity" onclick="toggleModal('termsModal')"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="flex justify-between items-center border-b pb-3 mb-4">
                        <h3 class="text-2xl font-bold text-gray-900">Terms of Service</h3>
                        <button onclick="toggleModal('termsModal')" class="text-gray-400 hover:text-gray-600 transition"><i class="fas fa-times text-xl"></i></button>
                    </div>
                    <div class="prose max-w-none text-sm text-gray-700 space-y-4">
                        <p><strong>1. Acceptance of Terms:</strong> By accessing SafetyGuide360, you agree to be bound by these Terms of Service.</p>
                        <p><strong>2. Use License:</strong> Permission is granted to temporarily download one copy of the materials for personal, non-commercial transitory viewing only. You may not reverse engineer any software contained on SafetyGuide360.</p>
                        <p><strong>3. Data Security:</strong> Our tools operate client-side. We do not save or store your personal inputs.</p>
                        <p><strong>4. Disclaimer:</strong> The tools are provided "as is". SafetyGuide360 makes no warranties, expressed or implied, regarding accuracy or reliability.</p>
                        <p><strong>5. Limitation of Liability:</strong> SafetyGuide360 shall not be liable for any damages resulting from the use or inability to use our tools.</p>
                        <p><strong>6. Modifications:</strong> We may revise these terms at any time without notice.</p>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 sm:ml-3 sm:w-auto sm:text-sm transition" onclick="toggleModal('termsModal')">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Affiliate Disclosure Modal -->
    <div id="affiliateModal" class="modal fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity" onclick="toggleModal('affiliateModal')"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="flex justify-between items-center border-b pb-3 mb-4">
                        <h3 class="text-2xl font-bold text-gray-900">Affiliate Disclosure</h3>
                        <button onclick="toggleModal('affiliateModal')" class="text-gray-400 hover:text-gray-600 transition"><i class="fas fa-times text-xl"></i></button>
                    </div>
                    <div class="prose max-w-none text-sm text-gray-700 space-y-4">
                        <p><strong>1. Introduction:</strong> SafetyGuide360 is a free service. To cover costs, we use affiliate links and advertising.</p>
                        <p><strong>2. Affiliate Links:</strong> Some links on this website are affiliate links. If you purchase through them, we may receive a commission at no extra cost to you. We are a participant in the <strong>Amazon Services LLC Associates Program</strong>.</p>
                        <p><strong>3. Editorial Integrity:</strong> Our recommendations are based on our belief in the product's value, regardless of affiliate relationships.</p>
                        <p><strong>4. Advertising:</strong> We display advertisements through Google AdSense (Publisher ID: pub-6687860250561653).</p>
                        <p><strong>5. Support Us:</strong> You can support us by using our affiliate links, donating via "Buy Me a Coffee", or simply using our tools.</p>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 sm:ml-3 sm:w-auto sm:text-sm transition" onclick="toggleModal('affiliateModal')">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main JavaScript -->
    <script>
        // --- VISITOR COUNTER ---
        class VisitorCounter {
            constructor() {
                this.counterKey = 'safetyguide360_visitor_counter';
                this.sessionKey = 'safetyguide360_session';
                this.counterElementId = 'visitorCounter';
                this.init();
            }

            init() {
                // Check if this is a new session
                if (!sessionStorage.getItem(this.sessionKey)) {
                    this.incrementCounter();
                    sessionStorage.setItem(this.sessionKey, 'active');
                }
                
                // Display the counter
                this.displayCounter();
                
                // Optional: Track with Google Analytics
                this.trackWithGA();
            }

            incrementCounter() {
                let count = localStorage.getItem(this.counterKey);
                
                if (!count) {
                    count = Math.floor(Math.random() * 5000) + 1000; // Start with random base count
                } else {
                    count = parseInt(count);
                }
                
                count++;
                localStorage.setItem(this.counterKey, count);
                
                return count;
            }

            getCounter() {
                let count = localStorage.getItem(this.counterKey);
                
                if (!count) {
                    count = Math.floor(Math.random() * 5000) + 1000;
                    localStorage.setItem(this.counterKey, count);
                }
                
                return parseInt(count);
            }

            displayCounter() {
                let count = this.getCounter();
                
                // Format number with commas
                const formattedCount = count.toLocaleString();
                
                // Update counter element
                const counterElement = document.getElementById(this.counterElementId);
                if (counterElement) {
                    counterElement.textContent = formattedCount;
                }
                
                // Add animation effect
                this.animateCounter();
            }

            animateCounter() {
                const counterElement = document.getElementById(this.counterElementId);
                if (counterElement) {
                    counterElement.classList.add('animate-pulse');
                    setTimeout(() => {
                        counterElement.classList.remove('animate-pulse');
                    }, 1000);
                }
            }

            trackWithGA() {
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'page_visit', {
                        'event_category': 'engagement',
                        'event_label': 'Visitor Counter',
                        'value': this.getCounter()
                    });
                }
            }
        }

        // Initialize visitor counter
        document.addEventListener('DOMContentLoaded', () => {
            window.visitorCounter = new VisitorCounter();
        });

        // --- MODAL LOGIC ---
        function toggleModal(modalID) {
            const modal = document.getElementById(modalID);
            const body = document.body;
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                body.classList.add('modal-active');
            } else {
                modal.classList.add('hidden');
                body.classList.remove('modal-active');
            }
        }

        // Close modal on Escape key
        document.onkeydown = function(evt) {
            evt = evt || window.event;
            if (evt.keyCode == 27) {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    if (!modal.classList.contains('hidden')) {
                        modal.classList.add('hidden');
                        document.body.classList.remove('modal-active');
                    }
                });
            }
        };

        // --- CALCULATION LOGIC ---
        const coverageFactors = { "2": 1.5, "5": 2.5, "10": 5.0, "15": 6.0 };
        const productData = {
            "FE36": {
                "2": { desc: "CLEAN AGENT CHEMOURS FE36 MODULAR - 2KG (Premium Electronics Protection)", rate: 19851 },
                "5": { desc: "CLEAN AGENT CHEMOURS FE36 MODULAR - 5KG (Data Center Grade)", rate: 41564 },
                "10": { desc: "CLEAN AGENT CHEMOURS FE36 MODULAR - 10KG (Large Server Rooms)", rate: 73502 },
                "15": { desc: "CLEAN AGENT CHEMOURS FE36 MODULAR - 15KG (Industrial Electronics)", rate: 105003 }
            },
            "HFC236fa": {
                "2": { desc: "CLEAN AGENT HFC 236fa MODULAR - 2KG (Telecom Applications)", rate: 16650 },
                "5": { desc: "CLEAN AGENT HFC 236fa MODULAR - 5KG (Medium Data Centers)", rate: 29901 },
                "10": { desc: "CLEAN AGENT HFC 236fa MODULAR - 10KG (Large Facilities)", rate: 51876 },
                "15": { desc: "CLEAN AGENT HFC 236fa MODULAR - 15KG (Industrial Applications)", rate: 84727 }
            },
            "MAP50": {
                "2": { desc: "MAP-50% DRY POWDER MODULAR - 2KG (General Purpose)", rate: 3150 },
                "5": { desc: "MAP-50% DRY POWDER MODULAR - 5KG (Commercial Buildings)", rate: 4288 },
                "10": { desc: "MAP-50% DRY POWDER MODULAR - 10KG (Warehouses)", rate: 6501 },
                "15": { desc: "MAP-50% DRY POWDER MODULAR - 15KG (Industrial Zones)", rate: 11001 }
            },
            "MAP90": {
                "2": { desc: "MAP-90% DRY POWDER MODULAR - 2KG (High Risk Areas)", rate: 3876 },
                "5": { desc: "MAP-90% DRY POWDER MODULAR - 5KG (Manufacturing Units)", rate: 5874 },
                "10": { desc: "MAP-90% DRY POWDER MODULAR - 10KG (Large Industrial)", rate: 8751 },
                "15": { desc: "MAP-90% DRY POWDER MODULAR - 15KG (Heavy Industry)", rate: 14501 }
            }
        };

        let customRooms = [];

        // Update progress bar
        function updateProgressBar() {
            const progressBar = document.getElementById('progressBar');
            const totalSteps = 3;
            let completedSteps = 0;
            
            if (document.getElementById('vendorName').value && document.getElementById('clientName').value) completedSteps++;
            if (document.getElementById('agentType').value) completedSteps++;
            if (customRooms.length > 0) completedSteps++;
            
            const progress = (completedSteps / totalSteps) * 100;
            progressBar.style.width = `${progress}%`;
        }

        function addCustomRoom() {
            const nameInput = document.getElementById('customRoomName');
            const lenInput = document.getElementById('customRoomLength');
            const widInput = document.getElementById('customRoomWidth');

            const name = nameInput.value.trim();
            const length = parseFloat(lenInput.value);
            const width = parseFloat(widInput.value);
            
            if (!name || isNaN(length) || isNaN(width)) {
                alert('Please enter a valid room name and dimensions.');
                return;
            }
            if (length <= 0 || width <= 0) {
                alert('Dimensions must be greater than zero.');
                return;
            }
            
            customRooms.push({ name, length, width });
            updateRoomTable();
            updateProgressBar();
            
            nameInput.value = '';
            lenInput.value = '';
            widInput.value = '';
            nameInput.focus();
        }

        function updateRoomTable() {
            const list = document.getElementById('customRoomsList');
            const emptyState = document.getElementById('emptyState');
            list.innerHTML = '';
            
            let totalArea = 0;
            
            if(customRooms.length === 0) {
                emptyState.style.display = 'block';
                list.parentElement.classList.add('hidden');
            } else {
                emptyState.style.display = 'none';
                list.parentElement.classList.remove('hidden');
                
                customRooms.forEach((room, index) => {
                    const area = (room.length * room.width).toFixed(2);
                    totalArea += parseFloat(area);
                    const row = document.createElement('tr');
                    row.className = "border-b hover:bg-gray-50 transition";
                    row.innerHTML = `
                        <td class="p-3 font-medium text-gray-700">${room.name}</td>
                        <td class="p-3 text-center text-gray-500">${room.length} × ${room.width}</td>
                        <td class="p-3 text-center font-mono font-medium">${area} m²</td>
                        <td class="p-3 text-right">
                            <button onclick="removeRoom(${index})" class="text-red-500 hover:text-red-700 hover:bg-red-50 p-2 rounded-full transition" title="Remove Room" aria-label="Remove room ${room.name}">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                    `;
                    list.appendChild(row);
                });
            }
            
            // Update summary
            document.getElementById('totalRooms').textContent = `Total Rooms: ${customRooms.length}`;
            document.getElementById('totalArea').textContent = `Total Area: ${totalArea.toFixed(2)} m²`;
        }

        window.removeRoom = function(index) {
            if (confirm('Are you sure you want to remove this room?')) {
                customRooms.splice(index, 1);
                updateRoomTable();
                updateProgressBar();
            }
        };

        function calculateRequirements() {
            if (customRooms.length === 0) {
                alert('Please add at least one room to calculate.');
                return;
            }

            const size = document.getElementById('extinguisherSize').value;
            const agent = document.getElementById('agentType').value;
            const coverage = coverageFactors[size];
            
            let totalArea = 0;
            let totalExtinguishers = 0;
            const breakdown = [];
            
            customRooms.forEach(room => {
                const area = room.length * room.width;
                const qty = Math.ceil(area / coverage);
                totalArea += area;
                totalExtinguishers += qty;
                breakdown.push({ 
                    name: room.name, 
                    area: area.toFixed(2), 
                    coverage: coverage.toFixed(1),
                    qty 
                });
            });
            
            const product = productData[agent][size];
            const netTotal = totalExtinguishers * product.rate;
            const gst = netTotal * 0.18;
            const grandTotal = netTotal + gst;
            
            displayResults(size, agent, totalArea, totalExtinguishers, breakdown, product, netTotal, gst, grandTotal);
        }

        function displayResults(size, agent, totalArea, totalQty, breakdown, product, net, gst, grand) {
            const vName = document.getElementById('vendorName').value || "Vendor Organization";
            const vContact = document.getElementById('vendorContact').value || "";
            const cName = document.getElementById('clientName').value || "Valued Customer";
            const cRef = document.getElementById('projectRef').value || "";

            document.getElementById('displayVendorName').textContent = vName;
            document.getElementById('displayVendorContact').textContent = vContact;
            document.getElementById('displayClientName').textContent = cName;
            document.getElementById('displayProjectRef').textContent = cRef;

            const sizeText = document.getElementById('extinguisherSize').options[document.getElementById('extinguisherSize').selectedIndex].text.split('(')[0];
            const agentText = document.getElementById('agentType').options[document.getElementById('agentType').selectedIndex].text.split('(')[0];
            
            document.getElementById('summaryContent').innerHTML = `
                <i class="fas fa-check-circle mt-1 mr-3 text-green-500 text-xl"></i>
                <div>
                    <p class="font-bold text-lg">Requirement Calculated Successfully!</p>
                    <p class="text-sm opacity-90">Based on a total area of <strong>${totalArea.toFixed(2)} m²</strong> across ${customRooms.length} rooms, you require <strong>${totalQty} units</strong> of <strong>${sizeText}</strong> ${agentText} modular extinguishers.</p>
                </div>
            `;
            
            // Room Breakdown
            const bdContent = document.getElementById('breakdownContent');
            bdContent.innerHTML = '';
            breakdown.forEach(item => {
                bdContent.innerHTML += `
                    <tr class="border-b hover:bg-gray-50">
                        <td class="p-2 font-medium">${item.name}</td>
                        <td class="text-center p-2 text-gray-500">${item.area}</td>
                        <td class="text-center p-2 text-gray-500">${item.coverage} m²/unit</td>
                        <td class="text-center p-2 font-bold text-gray-800 bg-gray-50 rounded">${item.qty}</td>
                    </tr>
                `;
            });
            
            // Quote Table
            const quoteContent = document.getElementById('quoteContent');
            quoteContent.innerHTML = `
                <tr class="bg-white border-b hover:bg-gray-50 transition">
                    <td class="p-4 font-medium">${product.desc}</td>
                    <td class="p-4 text-center font-bold text-lg">${totalQty}</td>
                    <td class="p-4 text-right font-mono text-gray-600">₹ ${product.rate.toLocaleString('en-IN')}</td>
                    <td class="p-4 text-right font-mono text-gray-600">₹ ${net.toLocaleString('en-IN')}</td>
                    <td class="p-4 text-right font-mono text-gray-600">₹ ${gst.toLocaleString('en-IN')}</td>
                    <td class="p-4 text-right font-bold text-lg text-green-700 font-mono">₹ ${grand.toLocaleString('en-IN')}</td>
                </tr>
            `;
            
            // Show results
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
            
            // Track calculation event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'calculation_completed', {
                    'event_category': 'engagement',
                    'event_label': 'Fire Extinguisher Calculation',
                    'value': totalQty
                });
            }
        }

        // --- EXPORT FUNCTIONS ---
        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            // Header with gradient effect
            doc.setFillColor(44, 62, 80);
            doc.rect(0, 0, 210, 40, 'F');
            
            // Title
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(22);
            doc.setFont(undefined, 'bold');
            doc.text('COMMERCIAL QUOTATION', 105, 20, null, null, 'center');
            
            // Subtitle
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('SafetyGuide360 Professional Fire Safety Tools', 105, 28, null, null, 'center');
            
            // Date
            const now = new Date();
            doc.text(`Generated: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`, 105, 35, null, null, 'center');

            doc.setTextColor(0, 0, 0);
            doc.setFontSize(10);
            
            // Vendor Details
            doc.setFont(undefined, 'bold');
            doc.text('VENDOR DETAILS:', 20, 55);
            doc.setFont(undefined, 'normal');
            doc.text(document.getElementById('vendorName').value || 'Vendor Name', 20, 62);
            doc.text(document.getElementById('vendorContact').value || '', 20, 67);

            // Client Details
            doc.setFont(undefined, 'bold');
            doc.text('CLIENT DETAILS:', 120, 55);
            doc.setFont(undefined, 'normal');
            doc.text(document.getElementById('clientName').value || 'Client Name', 120, 62);
            doc.text(document.getElementById('projectRef').value || '', 120, 67);

            // Divider line
            doc.setDrawColor(200, 200, 200);
            doc.line(20, 75, 190, 75);

            // Table Header
            let y = 85;
            doc.setFillColor(240, 240, 240);
            doc.rect(20, y-5, 170, 10, 'F');
            doc.setFont(undefined, 'bold');
            doc.setFontSize(9);
            doc.text('DESCRIPTION', 22, y+1);
            doc.text('QTY', 110, y+1);
            doc.text('RATE (₹)', 130, y+1);
            doc.text('TOTAL (₹)', 165, y+1);
            
            // Table Content
            y += 12;
            doc.setFont(undefined, 'normal');
            const quoteRow = document.querySelector('#quoteContent tr');
            if(quoteRow) {
                const cells = quoteRow.querySelectorAll('td');
                const desc = cells[0].textContent;
                const qty = cells[1].textContent;
                const rate = cells[2].textContent;
                const grandTotal = cells[5].textContent;

                const splitDesc = doc.splitTextToSize(desc, 80);
                const descHeight = splitDesc.length * 5;
                
                doc.text(splitDesc, 22, y);
                doc.text(qty, 110, y);
                doc.text(rate, 130, y);
                doc.setFont(undefined, 'bold');
                doc.text(grandTotal, 165, y);
                
                y += descHeight + 10;
            }

            // Summary Section
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('SUMMARY:', 20, y);
            doc.setFont(undefined, 'normal');
            y += 8;
            
            const totalRooms = customRooms.length;
            const totalArea = customRooms.reduce((sum, room) => sum + (room.length * room.width), 0);
            
            doc.text(`• Total Rooms: ${totalRooms}`, 25, y);
            y += 6;
            doc.text(`• Total Area: ${totalArea.toFixed(2)} m²`, 25, y);
            y += 6;
            doc.text(`• Quotation Valid: 30 Days`, 25, y);
            
            // Footer
            doc.setFontSize(8);
            doc.setTextColor(150, 150, 150);
            y = 280;
            doc.text('This is a system-generated estimate for planning purposes.', 105, y, null, null, 'center');
            y += 5;
            doc.text('Always verify actual site conditions with certified fire safety professionals.', 105, y, null, null, 'center');
            y += 5;
            doc.text('© 2025 SafetyGuide360 | www.safetyguide360.com', 105, y, null, null, 'center');
            
            doc.save(`SafetyGuide360_Quotation_${new Date().getTime()}.pdf`);
            
            // Track PDF export
            if (typeof gtag !== 'undefined') {
                gtag('event', 'pdf_export', {
                    'event_category': 'engagement',
                    'event_label': 'PDF Export'
                });
            }
        }

        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            
            // Vendor and Client Details
            const vendorName = document.getElementById('vendorName').value || 'Vendor Name';
            const clientName = document.getElementById('clientName').value || 'Client Name';
            
            const wsData = [
                ['SAFETYGUIDE360 - PROFESSIONAL COMMERCIAL OFFER'],
                ['Generated: ' + new Date().toLocaleString()],
                [],
                ['VENDOR DETAILS', '', '', 'CLIENT DETAILS'],
                ['Company:', vendorName, '', 'Client:', clientName],
                ['Contact:', document.getElementById('vendorContact').value || '', '', 'Reference:', document.getElementById('projectRef').value || ''],
                [],
                ['PRODUCT DETAILS'],
                ['Description', 'Quantity', 'Unit Rate (₹)', 'Net Total (₹)', 'GST 18% (₹)', 'Grand Total (₹)']
            ];
            
            // Quote Data
            const quoteRow = document.querySelector('#quoteContent tr');
            if(quoteRow) {
                const cells = quoteRow.querySelectorAll('td');
                const parseCurrency = (str) => parseFloat(str.replace(/[₹,]/g, ''));
                
                wsData.push([
                    cells[0].textContent,
                    parseInt(cells[1].textContent),
                    parseCurrency(cells[2].textContent),
                    parseCurrency(cells[3].textContent),
                    parseCurrency(cells[4].textContent),
                    parseCurrency(cells[5].textContent)
                ]);
            }
            
            wsData.push([], ['ROOM BREAKDOWN']);
            wsData.push(['Room Name', 'Length (m)', 'Width (m)', 'Area (m²)', 'Units Required']);
            
            customRooms.forEach(room => {
                const area = (room.length * room.width).toFixed(2);
                const coverage = coverageFactors[document.getElementById('extinguisherSize').value];
                const qty = Math.ceil(room.length * room.width / coverage);
                
                wsData.push([
                    room.name,
                    room.length,
                    room.width,
                    parseFloat(area),
                    qty
                ]);
            });
            
            wsData.push(
                [],
                ['SUMMARY'],
                ['Total Rooms:', customRooms.length],
                ['Total Area (m²):', customRooms.reduce((sum, room) => sum + (room.length * room.width), 0).toFixed(2)],
                ['Quotation Valid Until:', new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toLocaleDateString()],
                [],
                ['DISCLAIMER'],
                ['This is a system-generated estimate. Always consult with certified fire safety professionals.'],
                ['© 2025 SafetyGuide360 - Professional Fire Safety Tools']
            );
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            
            // Set column widths
            const wscols = [
                {wch: 40},  // Description
                {wch: 10},  // Quantity
                {wch: 15},  // Unit Rate
                {wch: 15},  // Net Total
                {wch: 15},  // GST
                {wch: 20}   // Grand Total
            ];
            ws['!cols'] = wscols;
            
            // Add some styling through cell merging
            ws['!merges'] = [
                XLSX.utils.decode_range("A1:F1"),
                XLSX.utils.decode_range("A2:F2"),
                XLSX.utils.decode_range("A4:F4"),
                XLSX.utils.decode_range("A7:F7"),
                XLSX.utils.decode_range("A13:F13"),
                XLSX.utils.decode_range("A19:F19"),
                XLSX.utils.decode_range("A20:F20")
            ];

            XLSX.utils.book_append_sheet(wb, ws, "Commercial Quote");
            XLSX.writeFile(wb, `SafetyGuide360_Quote_${new Date().getTime()}.xlsx`);
            
            // Track Excel export
            if (typeof gtag !== 'undefined') {
                gtag('event', 'excel_export', {
                    'event_category': 'engagement',
                    'event_label': 'Excel Export'
                });
            }
        }

        // --- EVENT LISTENERS ---
        document.addEventListener('DOMContentLoaded', () => {
            // Room management
            document.getElementById('addCustomRoom').addEventListener('click', addCustomRoom);
            
            // Input fields for progress tracking
            const trackedInputs = ['vendorName', 'vendorContact', 'clientName', 'agentType', 'extinguisherSize'];
            trackedInputs.forEach(id => {
                document.getElementById(id).addEventListener('input', updateProgressBar);
                document.getElementById(id).addEventListener('change', updateProgressBar);
            });
            
            // Calculate button
            document.getElementById('calculateBtn').addEventListener('click', calculateRequirements);
            
            // Export buttons
            document.getElementById('exportPDF').addEventListener('click', exportToPDF);
            document.getElementById('exportExcel').addEventListener('click', exportToExcel);
            
            // Enter key to add room
            document.getElementById('customRoomWidth').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') addCustomRoom();
            });
            
            // Initialize progress bar
            updateProgressBar();
            
            // Initialize room table
            updateRoomTable();
            
            // Track page view
            if (typeof gtag !== 'undefined') {
                gtag('event', 'page_view', {
                    'page_title': 'Fire Extinguisher Calculator',
                    'page_location': window.location.href
                });
            }
            
            // Load AdSense ads
            (adsbygoogle = window.adsbygoogle || []).push({});
        });

        // --- HELPER FUNCTIONS ---
        function validateInputs() {
            const required = ['vendorName', 'clientName'];
            let isValid = true;
            
            required.forEach(id => {
                const element = document.getElementById(id);
                if (!element.value.trim()) {
                    element.style.borderColor = '#ff4c4c';
                    isValid = false;
                } else {
                    element.style.borderColor = '#d1d5db';
                }
            });
            
            return isValid;
        }

        function resetForm() {
            if (confirm('Are you sure you want to reset all inputs?')) {
                customRooms = [];
                updateRoomTable();
                updateProgressBar();
                
                const resetIds = ['vendorName', 'vendorContact', 'clientName', 'projectRef'];
                resetIds.forEach(id => {
                    document.getElementById(id).value = '';
                });
                
                document.getElementById('resultsSection').classList.add('hidden');
            }
        }
        
        // Social Sharing Analytics
        function trackSocialShare(platform) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'social_share', {
                    'event_category': 'engagement',
                    'event_label': platform,
                    'value': 1
                });
            }
        }
        
        // Add tracking to social buttons
        document.querySelectorAll('a[href*="facebook.com/sharer"]').forEach(btn => {
            btn.addEventListener('click', () => trackSocialShare('facebook'));
        });
        document.querySelectorAll('a[href*="twitter.com/intent/tweet"]').forEach(btn => {
            btn.addEventListener('click', () => trackSocialShare('twitter'));
        });
        document.querySelectorAll('a[href*="linkedin.com/shareArticle"]').forEach(btn => {
            btn.addEventListener('click', () => trackSocialShare('linkedin'));
        });
        document.querySelectorAll('a[href*="wa.me"]').forEach(btn => {
            btn.addEventListener('click', () => trackSocialShare('whatsapp'));
        });
    </script>
</body>
</html>
